# See ltrace.conf(5) for description of syntax of this file.

import "libc.so-types";

void __libc_start_main(hide(void*), hide(int), array(string, arg2));

# arpa/inet.h
int inet_aton(string, +in_addr*);
hex(uint) inet_addr(string);
hex(uint) inet_network(string);
string inet_ntoa(in_addr);
in_addr inet_makeaddr(hex(int), hex(int));
hex(uint) inet_lnaof(in_addr);
hex(uint) inet_netof(in_addr);

# bfd.h
void bfd_init();
int bfd_set_default_target(string);
addr bfd_scan_vma(string, addr, int);
addr bfd_openr(string,string);
int bfd_check_format(addr,int);

# ctype.h
char tolower(char);
char toupper(char);
addr __ctype_b_loc();
addr __ctype_tolower_loc();
addr __ctype_toupper_loc();
ulong __ctype_get_mb_cur_max();

# curses.h
int waddch(addr, char);
int mvprintw(int, int, format);
int wmove(addr, int, int);
int waddnstr(addr, string, int);
string tgoto(string, int, int);
int wgetch(addr);
string tgetstr(string, +string*);

typedef MEVENT = struct(short, int, int, int, hex(ulong));
int getmouse(MEVENT*);

# dirent.h
dirent *readdir(DIR *);
dirent64 *readdir64(DIR *);
int closedir(DIR *);
DIR *opendir(string);
DIR *fdopendir(int);
int dirfd(DIR *);
void rewinddir(DIR *);
long telldir(DIR *);
void seekdir(DIR *, long);

# dlfcn.h
addr  dlopen(string, int);
string dlerror();
addr  dlsym(addr, string);
int dlclose(addr);

# errno.h
int* __errno_location();

# fcntl.h
typedef openat_fd = enum(AT_FDCWD=-100);
int open(string,hex(int),octal);		; WARNING: 3rd argument may not be there
int open64(string,hex(int),octal);		; WARNING: 3rd argument may not be there
int openat(openat_fd,string,hex(int),octal);	; WARNING: 4th argument may not be there
int openat64(openat_fd,string,hex(int),octal);	; WARNING: 4th argument may not be there
long splice(int,llong*,int,llong*,ulong,bin(uint))
int linkat(openat_fd,string,openat_fd,string,int);
int renameat(openat_fd,string,openat_fd,string);
int renameat2(openat_fd,string,openat_fd,string,int);
int mkdirat(openat_fd,string,octal);
# unistd.h
long copy_file_range(int,llong*,int,llong*,ulong,bin(uint))
# sys/sendfile.h
long sendfile(int,int,long*,ulong)
long sendfile64(int,int,llong*,ulong)

# fnmatch.h
int fnmatch(string, string, int);

# getopt.h
int getopt_long(int,addr,string,addr,+int*);
int getopt_long_only(int,addr,string,addr,+int*);

# grp.h
void endgrent();
addr getgrnam(string);
void setgrent();
addr getgrent();

# libintl.h
string __dcgettext(string,string,int);
string bindtextdomain(string, string);
string textdomain(string);
string gettext(string);
string dgettext(string, string);
string dcgettext(string, string, int);

# libio.h
char _IO_getc(file);
int _IO_putc(char,file);

# locale.h
string setlocale(enum(LC_CTYPE=0, LC_NUMERIC=1, LC_TIME=2, LC_COLLATE=3, LC_MONETARY=4, LC_MESSAGES=5, LC_ALL=6, LC_PAPER=7, LC_NAME=8, LC_ADDRESS=9, LC_TELEPHONE=10, LC_MEASUREMENT=11, LC_IDENTIFICATION=12), string);
addr duplocale(addr);
addr uselocale(addr);
addr newlocale(bin(int),string,addr);
void freelocale(addr);
string nl_langinfo(int);

# mcheck.h
void mtrace();
void muntrace();

# mqueue.h
int mq_open(string, int, octal, addr);  ; WARNING: 3rd and 4th arguments may not be there
int mq_close(int);
int mq_unlink(string);
int mq_getattr(int, addr);
int mq_setattr(int, addr, addr);
int mq_notify(int, addr);
int mq_send(int, string3, ulong, uint);
int mq_timedsend(int, string3, ulong, uint, addr);
long mq_receive(int, +string0, ulong, addr);
long mq_timedreceive(int, +string0, ulong, addr, addr);

# netdb.h
void endhostent();
void endnetent();
void endnetgrent();
void endprotoent();
void endservent();
void freeaddrinfo(addr);
string gai_strerror(int);
int getaddrinfo(string, string, addr, addr);
addr gethostbyaddr(string, uint, int);
addr gethostbyname(string);
addr gethostent();
int getnameinfo(addr, uint, string, uint, string, uint, uint);
addr getnetbyaddr(uint, int);
addr getnetbyname(string);
addr getnetent();
int getnetgrent(addr, addr, addr);
addr getprotobyname(string);
addr getprotobynumber(int);
addr getprotoent();
addr getservbyname(string, string);
addr getservbyport(int, string);
addr getservent();
void herror(string);
string hstrerror(int);
int rcmd(addr, ushort, string, string, string, addr);
int rcmd_af(addr, ushort, string, string, string, addr, int);
int rexec(addr, int, string, string, string, addr);
int rexec_af(addr, int, string, string, string, addr, int);
int rresvport (addr);
int rresvport_af (addr, int);
int ruserok(string, int, string, string);
int ruserok_af(string, int, string, string, int);
void sethostent(int);
void setnetent(int);
int setnetgrent(string);
void setprotoent(int);
void setservent(int);

# netinet/in.h
uint ntohs(uint);

# pcap.h
string pcap_lookupdev(addr);
addr pcap_open_live(string, int, int, int, addr);
int pcap_snapshot(addr);
int pcap_lookupnet(string, addr, addr, addr);
int pcap_compile(addr, addr, string, int, addr);

# pwd.h
string getpass(string);
void endpwent();
addr getpwnam(string);
void setpwent();

# readline/readline.h
string readline(string);

# signal.h
int kill(int, signum);
int sigemptyset(+sigset_t*);
int sigaddset(+sigset_t*, signum);
int sigdelset(+sigset_t*, signum);
int sigfillset(+sigset_t*);
int sigismember(sigset_t*, signum);
addr signal(signum,addr);
int sigaction(signum, sigaction*, +sigaction*);
int sigprocmask(enum(SIG_BLOCK=1, SIG_UNBLOCK=2, SIG_SETMASK=3), sigset_t*, +sigset_t*);
int sigpending(+sigset_t*);
int sigsuspend(sigset_t*);
int sigisemptyset(sigset_t*);
int sigorset(+sigset_t*, sigset_t*, sigset_t*);
int sigandset(+sigset_t*, sigset_t*, sigset_t*);

# stdio.h
int fclose(file);
int feof(file);
int ferror(file);
int fflush(file);
char fgetc(file);
int ungetc(int, file);
addr fgets(+string, int, file);
int fileno(file);
file fopen(string,string);
file fopen64(string,string);
file fdopen(int, string);
file freopen(string,string,string,file);
file fmemopen(+string2,ulong,string);
file open_memstream(addr,addr);
file open_wmemstream(addr,addr);
int fprintf(file,format);
int fputc(char,file);
int fputs(string,file);
ulong fread(addr,ulong,ulong,file);
ulong fread_unlocked(addr,ulong,ulong,file);
ulong fwrite(string,ulong,ulong,file);
ulong fwrite_unlocked(string,ulong,ulong,file);
typedef lseek_whence = enum(SEEK_SET=0, SEEK_CUR=1, SEEK_END=2, SEEK_DATA=3, SEEK_HOLE=4);
int fseek(file,long,lseek_whence);
int fseeko(file,long,lseek_whence);
int fseeko64(file,llong,lseek_whence);
long ftell(file);
long ftello(file);
llong ftello64(file);
int pclose(addr);
void perror(string);
addr popen(string, string);
int printf(format);
int puts(string);
int remove(string);
int snprintf(+string2,ulong,format);
int sprintf(+string,format);
int asprintf(+string*,format);
string tempnam(string,string);
int vfprintf(file,string,addr);
int vsnprintf(+string2,ulong,string,addr);
int vasprintf(+string*,string,addr);
int setvbuf(file,addr,int,ulong);
void setbuf(file,addr);
void setbuffer(file,addr,ulong);
void setlinebuf(file);
int rename(string,string);
long getline(+string*,long*,file);
long getdelim(+string*,long*,char,file);
long __getdelim(+string*,long*,char,file);

# xlocale.h
locale_t newlocale(hex(int), string, locale_t);

# stdlib.h
long __strtol_internal(string, +string*, int);
llong __strtoll_internal(string,addr,int);
ulong __strtoul_internal(string, +string*, int);
ullong __strtoull_internal(string,addr,int);
long strtol(string,+string*,int);
llong strtoll(string,+string*,int);
ulong strtoul(string,+string*,int);
ullong strtoull(string,+string*,int);

double strtod(string, +string*);
float strtof(string, +string*);
ldouble strtold(string, +string*);

double strtod_l(string, +string*, locale_t);
float strtof_l(string, +string*, locale_t);
ldouble strtold_l(string, +string*, locale_t);

int atexit(addr);
addr bsearch(string, addr, ulong, ulong, addr);
addr calloc(ulong, ulong);
void exit(int);
void free(addr);
string getenv(string);
int putenv(string);
int setenv(string,string,int);
void unsetenv(string);
addr malloc(ulong);
void qsort(addr,ulong,ulong,addr);
void qsort_r(addr,ulong,ulong,addr,addr);
addr realloc(addr,ulong);
addr reallocarray(addr,ulong,ulong);
int system(string);

int rand();
int rand_r(uint*);
void srand(uint);
long random();
void srandom(uint);
void* initstate(uint, void*, ulong);
void* setstate(void*);
int random_r(void*, +int*);
int srandom_r(uint, void*);
int initstate_r(uint, void*, ulong, void*);
int setstate_r(void*, void*);
double drand48();
double erand48(+array(ushort,3)*);
long lrand48();
long nrand48(+array(ushort,3)*);
long mrand48();
long jrand48(+array(ushort,3)*);
void srand48(long);
array(ushort,3)* seed48(array(ushort,3)*);
void lcong48(array(ushort,7)*);

# string.h
void bcopy(addr,addr,ulong);
void bzero(addr,ulong);
string basename(string);
string __xpg_basename(string);
string index(string,char);
addr memchr(string,char,ulong);
addr memcpy(addr,string(array(char, arg3)*),ulong);
addr memmove(addr,string(array(char, arg3)*),ulong);
addr memset(addr,char,long);
string rindex(string,char);
addr stpcpy(addr,string);
int strcasecmp(string, string);
int strncasecmp(string3, string3, ulong);
string strcat(string, string);
string strchr(string,char);
int strcoll(string,string);
ulong strlen(string);
ulong strnlen(string,ulong);
int strcmp(string,string);
int strverscmp(string,string);
int memcmp(string[arg3],string[arg3],ulong);
int bcmp(string[arg3],string[arg3],ulong);
addr strcpy(addr,string);
addr strdup(string);
string strerror(int);
int strncmp(string,string,ulong);
addr strncpy(addr,string3,ulong);
string strrchr(string,char);
string strsep(addr,string);
ulong strspn(string,string);
ulong strcspn(string,string);
string strstr(string,string);
string strtok(string, string);
string strtok_r(string, string, +string*);
string strpbrk(string, string);

# sys/ioctl.h
int ioctl(int, int, addr);

# sys/socket.h
int socket(int,int,int);

# sys/stat.h
int __fxstat(int,int,addr);
int __xstat(int,string,addr);
int __lxstat(int,string,addr);
int __fxstat64(int,int,addr);
int __xstat64(int,string,addr);
int __lxstat64(int,string,addr);
int stat(string,addr);
int stat64(string,addr);
int fstat(int,addr);
int fstat64(int,addr);
int lstat(string,addr);
int fstatat(openat_fd,string,addr,bin(int));
int chmod(string,octal);
int fchmod(int,octal);
int mkfifo(string,octal);
octal umask(octal);

# sys/utsname.h
int uname(addr);

# sys/vfs.h
int statfs(string,addr);
int fstatfs(int,addr);
int fstatfs64(int,addr);

# syslog.h
void closelog();
void openlog(string,int,int);
void syslog(int,format);

# term.h
int tputs(string, int, addr);

# termios.h
int tcgetattr(int,addr);
int tcsetattr(int,int,addr);

# time.h
typedef tm = struct(int,int,int,int,int,int,int,int,int,long,string);
string ctime(addr);
int gettimeofday(addr, addr);
tm* gmtime(llong*);
tm* localtime(llong*);
tm* gmtime_r(llong*,addr);
tm* localtime_r(llong*,addr);
ulong strftime(+string2,ulong,string,tm*);
ulong strftime_l(+string2,ulong,string,tm*,addr);
llong time(addr);
llong mktime(tm*);
int nanosleep(timespec*, timespec*);

# unistd.h
void _exit(int);
int access(string, int);
uint alarm(uint);
int chdir(string);
int chown(string,int,int);
int close(int);
string crypt(string,string);
int dup2(int,int);
int execlp(string,string,addr,addr,addr);
int execv(string,addr);
int fchdir(int);
int fork();
int vfork();
int ftruncate(int,ulong);
string2 getcwd(addr,ulong);
string realpath(string,+string);
string canonicalize_file_name(string);
int getdomainname(+string2,ulong);
int geteuid();
int getegid();
int getgid();
int gethostname(+string2,ulong);
string getlogin();
int getopt(int,addr,string);
int getsubopt(string*, addr, +string*);
int getpid();
int getppid();
int getuid();
int getpgrp();
int setpgrp();
int getpgid(int);
int isatty(int);
int link(string,string);
int mkdir(string,octal);
long read(int, +string[retval], ulong);
long pread(int, +string[retval], ulong, long);
long pread64(int, +string[retval], ulong, llong);
int rmdir(string);
int seteuid(uint);
int setgid(int);
int sethostname(+string2,ulong);
int setpgid(int,int);
int setreuid(uint, uint);
int setuid(int);
uint sleep(uint);
int symlink(string,string);
void sync();
int fsync(int);
int fdatasync(int);
int syncfs(int);
int truncate(string,ulong);
string ttyname(int);
int unlink(string);
void usleep(uint);
long write(int, string3, ulong);
long pwrite(int, string3, ulong, long);
long pwrite64(int, string3, ulong, llong);
addr sbrk(long);
int getpagesize();
long lseek(int,long,lseek_whence);
long lseek64(int,llong,lseek_whence);
int pipe(+array(int,2));
int pipe2(+array(int,2),hex(int));
long sysconf(enum(_SC_ARG_MAX=0, _SC_CHILD_MAX=1, _SC_CLK_TCK=2, _SC_NGROUPS_MAX=3, _SC_OPEN_MAX=4, _SC_STREAM_MAX=5, _SC_TZNAME_MAX=6, _SC_JOB_CONTROL=7, _SC_SAVED_IDS=8, _SC_REALTIME_SIGNALS=9, _SC_PRIORITY_SCHEDULING=10, _SC_TIMERS=11, _SC_ASYNCHRONOUS_IO=12, _SC_PRIORITIZED_IO=13, _SC_SYNCHRONIZED_IO=14, _SC_FSYNC=15, _SC_MAPPED_FILES=16, _SC_MEMLOCK=17, _SC_MEMLOCK_RANGE=18, _SC_MEMORY_PROTECTION=19, _SC_MESSAGE_PASSING=20, _SC_SEMAPHORES=21, _SC_SHARED_MEMORY_OBJECTS=22, _SC_AIO_LISTIO_MAX=23, _SC_AIO_MAX=24, _SC_AIO_PRIO_DELTA_MAX=25, _SC_DELAYTIMER_MAX=26, _SC_MQ_OPEN_MAX=27, _SC_MQ_PRIO_MAX=28, _SC_VERSION=29, _SC_PAGE_SIZE=30, _SC_PAGESIZE=30, _SC_RTSIG_MAX=31, _SC_SEM_NSEMS_MAX=32, _SC_SEM_VALUE_MAX=33, _SC_SIGQUEUE_MAX=34, _SC_TIMER_MAX=35, _SC_BC_BASE_MAX=36, _SC_BC_DIM_MAX=37, _SC_BC_SCALE_MAX=38, _SC_BC_STRING_MAX=39, _SC_COLL_WEIGHTS_MAX=40, _SC_EXPR_NEST_MAX=42, _SC_LINE_MAX=43, _SC_RE_DUP_MAX=44, _SC_2_VERSION=46, _SC_2_C_BIND=47, _SC_2_C_DEV=48, _SC_2_FORT_DEV=49, _SC_2_FORT_RUN=50, _SC_2_SW_DEV=51, _SC_2_LOCALEDEF=52, _SC_UIO_MAXIOV=60, _SC_IOV_MAX=60, _SC_THREADS=67, _SC_THREAD_SAFE_FUNCTIONS=68, _SC_GETGR_R_SIZE_MAX=69, _SC_GETPW_R_SIZE_MAX=70, _SC_LOGIN_NAME_MAX=71, _SC_TTY_NAME_MAX=72, _SC_THREAD_DESTRUCTOR_ITERATIONS=73, _SC_THREAD_KEYS_MAX=74, _SC_THREAD_STACK_MIN=75, _SC_THREAD_THREADS_MAX=76, _SC_THREAD_ATTR_STACKADDR=77, _SC_THREAD_ATTR_STACKSIZE=78, _SC_THREAD_PRIORITY_SCHEDULING=79, _SC_THREAD_PRIO_INHERIT=80, _SC_THREAD_PRIO_PROTECT=81, _SC_THREAD_PROCESS_SHARED=82, _SC_NPROCESSORS_CONF=83, _SC_NPROCESSORS_ONLN=84, _SC_PHYS_PAGES=85, _SC_AVPHYS_PAGES=86, _SC_ATEXIT_MAX=87, _SC_PASS_MAX=88, _SC_XOPEN_VERSION=89, _SC_XOPEN_XCU_VERSION=90, _SC_XOPEN_UNIX=91, _SC_XOPEN_CRYPT=92, _SC_XOPEN_ENH_I18N=93, _SC_XOPEN_SHM=94, _SC_2_CHAR_TERM=95, _SC_2_UPE=97, _SC_XOPEN_XPG2=98, _SC_XOPEN_XPG3=99, _SC_XOPEN_XPG4=100, _SC_NZERO=109, _SC_XBS5_ILP32_OFF32=125, _SC_XBS5_ILP32_OFFBIG=126, _SC_XBS5_LP64_OFF64=127, _SC_XBS5_LPBIG_OFFBIG=128, _SC_XOPEN_LEGACY=129, _SC_XOPEN_REALTIME=130, _SC_XOPEN_REALTIME_THREADS=131, _SC_ADVISORY_INFO=132, _SC_BARRIERS=133, _SC_CLOCK_SELECTION=137, _SC_CPUTIME=138, _SC_THREAD_CPUTIME=139, _SC_MONOTONIC_CLOCK=149, _SC_READER_WRITER_LOCKS=153, _SC_SPIN_LOCKS=154, _SC_REGEXP=155, _SC_SHELL=157, _SC_SPAWN=159, _SC_SPORADIC_SERVER=160, _SC_THREAD_SPORADIC_SERVER=161, _SC_TIMEOUTS=164, _SC_TYPED_MEMORY_OBJECTS=165, _SC_2_PBS=168, _SC_2_PBS_ACCOUNTING=169, _SC_2_PBS_LOCATE=170, _SC_2_PBS_MESSAGE=171, _SC_2_PBS_TRACK=172, _SC_SYMLOOP_MAX=173, _SC_STREAMS=174, _SC_2_PBS_CHECKPOINT=175, _SC_V6_ILP32_OFF32=176, _SC_V6_ILP32_OFFBIG=177, _SC_V6_LP64_OFF64=178, _SC_V6_LPBIG_OFFBIG=179, _SC_HOST_NAME_MAX=180, _SC_TRACE=181, _SC_TRACE_EVENT_FILTER=182, _SC_TRACE_INHERIT=183, _SC_TRACE_LOG=184, _SC_IPV6=235, _SC_RAW_SOCKETS=236, _SC_V7_ILP32_OFF32=237, _SC_V7_ILP32_OFFBIG=238, _SC_V7_LP64_OFF64=239, _SC_V7_LPBIG_OFFBIG=240, _SC_SS_REPL_MAX=241, _SC_TRACE_EVENT_NAME_MAX=242, _SC_TRACE_NAME_MAX=243, _SC_TRACE_SYS_MAX=244, _SC_TRACE_USER_EVENT_MAX=245, _SC_XOPEN_STREAMS=246, _SC_THREAD_ROBUST_PRIO_INHERIT=247, _SC_THREAD_ROBUST_PRIO_PROTECT=248, _SC_MINSIGSTKSZ=249, _SC_SIGSTKSZ=250))

# sys/uio.h
typedef iovec = struct(string[elt2],ulong);
long readv(int,+array(iovec,arg3),int);
long writev(int,array(iovec,arg3),int);
long preadv(int,+array(iovec,arg3),int,long);
long pwritev(int,array(iovec,arg3),int,long);
long preadv64(int,+array(iovec,arg3),int,llong);
long pwritev64(int,array(iovec,arg3),int,llong);
long preadv2(int,+array(iovec,arg3),int,long,hex(int));
long pwritev2(int,array(iovec,arg3),int,long,hex(int));
long preadv64v2(int,+array(iovec,arg3),int,llong,hex(int));
long pwritev64v2(int,array(iovec,arg3),int,llong,hex(int));

# utmp.h
void endutent();
addr getutent();
void setutent();

# wchar.h
int fwide(FILE*, int);
wint_t btowc(int);

wint_t getwc(FILE *);
wint_t getwchar();
wint_t fgetwc(FILE*);
wstring_t fgetws(+wstring2_t, int, FILE*);
wint_t ungetwc(wint_t, FILE*);

wint_t fputwc(wchar_t, FILE*);
int fputws(wstring_t, FILE*);
wint_t putwc(wchar_t, FILE*);
wint_t putwchar(wchar_t);

int wprintf(format(wstring_t));
int fwprintf(FILE*, format(wstring_t));
int swprintf(+wstring2_t, ulong, format(wstring_t));
int vfwprintf(FILE*, wstring_t, addr);
int vwprintf(wstring_t, addr);
int vswprintf(+wstring2_t, ulong, wstring_t, addr);

; int wscanf(const wchar_t *restrict, ...);
; int fwscanf(FILE *restrict, const wchar_t *restrict, ...);
; int swscanf(const wchar_t *restrict, const wchar_t *restrict, ...);
; int vfwscanf(FILE *restrict, const wchar_t *restrict, va_list);
; int vswscanf(const wchar_t *restrict, const wchar_t *restrict, va_list);
; int vwscanf(const wchar_t *restrict, va_list);

bool(int) iswalnum(wint_t);
bool(int) iswalpha(wint_t);
bool(int) iswcntrl(wint_t);
bool(int) iswdigit(wint_t);
bool(int) iswgraph(wint_t);
bool(int) iswlower(wint_t);
bool(int) iswprint(wint_t);
bool(int) iswpunct(wint_t);
bool(int) iswspace(wint_t);
bool(int) iswupper(wint_t);
bool(int) iswxdigit(wint_t);
uint wctype(string);
bool(int) iswctype(wint_t, uint);

ulong mbrlen(string, ulong, addr);
ulong mbrtowc(+wchar_t*, string[arg3], ulong, addr);
ulong mbtowc(+wchar_t*, string[arg3], ulong);
ulong mbsrtowcs(+wstring3_t, string*, ulong, addr);
ulong wctomb(+string0, wchar_t);
ulong wcrtomb(+string0, wchar_t, addr);
ulong wcsrtombs(+string3, wstring_t*, ulong, addr);
int mbsinit(addr);

wint_t towlower(wint_t);
wint_t towupper(wint_t);

wstring_t wcscat(wstring_t, wstring_t);
wstring_t wcsncat(wstring3_t, wstring_t, ulong);
wstring_t wcschr(wstring_t, wchar_t);
wstring_t wcsrchr(wstring_t, wchar_t);
int wcscmp(wstring_t, wstring_t);
int wcsncmp(wstring3_t, wstring3_t, ulong);
int wcscoll(wstring_t, wstring_t);
addr wcscpy(addr, wstring_t);
addr wcsncpy(addr, wstring_t, ulong);
ulong wcslen(wstring_t);

wstring_t wcsstr(wstring_t, wstring_t);
wstring_t wcswcs(wstring_t, wstring_t);

ulong wcscspn(wstring_t, wstring_t);
ulong wcsspn(wstring_t, wstring_t);
wstring_t wcspbrk(wstring_t, wstring_t);
wstring_t wcstok(wstring_t, wstring_t, +wstring_t*);

ulong wcsftime(+wstring2_t, ulong, wstring_t, addr);

double wcstod(wstring_t, +wstring_t*);
float wcstof(wstring_t, +wstring_t*);
ldouble wcstold(wstring_t, +wstring_t*);
long wcstol(wstring_t, +wstring_t*, int);
llong wcstoll(wstring_t, +wstring_t*, int);
ulong wcstoul(wstring_t, +wstring_t*, int);
ullong wcstoull(wstring_t, +wstring_t*, int);

int wcwidth(wchar_t);
int wcswidth(wstring2_t, ulong);

wstring_t wmemchr(wstring3_t, wchar_t, ulong);
int wmemcmp(wstring3_t, wstring3_t, ulong);
int wctob(wint_t);
wstring3_t wmemcpy(addr, wstring3_t, ulong);
wstring3_t wmemmove(addr, wstring3_t, ulong);
wstring3_t wmemset(addr, wchar_t, ulong);

# sys/wait.h
int wait(addr);
int waitpid(int,addr,int);

# sys/mman.h
addr mmap(addr,ulong,bin(int),hex(int),int,long);
addr mmap64(addr,ulong,bin(int),hex(int),int,llong);
int munmap(addr, ulong);

# cxxabi.h
addr _Znwm(ulong);  operator new
void _ZdlPv(addr);  operator delete
void __cxa_finalize(addr);

# other symbols not included above
long a64l(string);
string l64a(long);
void abort();
int abs(int);
long labs(long);

int addmntent(file, mntent*);
int endmntent(file);
int __endmntent(file);
file setmntent(string,string);
file __setmntent(string,string);
mntent *getmntent(addr);
mntent *getmntent_r(file, +mntent*, string, int);
mntent *__getmntent_r(file, +mntent*, string, int);
string hasmntopt(mntent*, string);

# XXX the third argument is a bitfield
addr mmap(addr, size_t, hex(int), mmap_flags_t, int, off_t);
addr mmap64(addr, size_t, hex(int), mmap_flags_t, int, off_t64);
void munmap(addr, size_t);
int mprotect(addr, ulong, hex(int));
int msync(addr, size_t, hex(int));
int madvise(addr, size_t, enum(MADV_NORMAL=0, MADV_RANDOM=1, MADV_SEQUENTIAL=2, MADV_WILLNEED=3, MADV_DONTNEED=4, MADV_REMOVE=9, MADV_DONTFORK=10, MADV_DOFORK=11, MADV_MERGEABLE=12, MADV_UNMERGEABLE=13, MADV_HUGEPAGE=14, MADV_NOHUGEPAGE=15, MADV_DONTDUMP=16, MADV_DODUMP=17, MADV_HWPOISON=100));
int posix_madvise (addr, size_t, enum(POSIX_MADV_NORMAL=0, POSIX_MADV_RANDOM=1, POSIX_MADV_SEQUENTIAL=2, POSIX_MADV_WILLNEED=3, POSIX_MADV_DONTNEED=4));
int mlock(addr, size_t);
int munlock(addr, size_t);
int mlockall(hex(int));
int munlockall();
# XXX the 16 should really be (arg2 + 4095 / 4096), but ltrace can't
# express that
int mincore(addr, size_t, +array(hex(char), 16)*);
addr mremap(addr, size_t, size_t, hex(int));
int remap_file_pages(addr, size_t, int, size_t, mmap_flags_t);
int shm_open(string, hex(int), oct(int));
int shm_unlink(string);

# libc.so defines several functions from libpthread.so.
# Rather than cherrypick, just import them all.

import "libpthread.so";
